(()=>{"use strict";const e=window.wp.element,t=window.wp.apiFetch,s=window.wp.components,a=window.wp.i18n;function l(l){const[n,r]=(0,e.useState)([]),[c,o]=(0,e.useState)(null),[i,d]=(0,e.useState)(""),[u,m]=(0,e.useState)(!1),f=(0,e.useRef)(null),b=(0,e.useRef)(null),h=(0,e.useRef)(null),p=(0,e.useRef)(null);(0,e.useEffect)((()=>{f.current.scrollTo(0,f.current.scrollHeight)}),[n]);const[y,g]=(0,e.useState)(),w=async e=>{if(0===e.trim().length)return;const s=(new Date).toISOString();r((t=>[...t,{session:s,messageClasses:"user-chat-message",avatar:"bi-chat-left-dots",text:e,message_date:s}]));const a=await t({path:"np/v1/completion",method:"POST",data:{text:e,session:s,message_date:s,response_id:c}});2==a.status?(m(!0),r((e=>[...e,{session:"chatbot-session",messageClasses:"ia-chat-message font-semibold",avatar:"bi-robot",text:"Job: "+a.result,message_date:(new Date).toISOString()}])),o(a?.responseID)):console.error(a?.error?.message)};return(0,e.createElement)(e.Fragment,null,(0,e.createElement)("div",{ref:p,class:"chatbot-container rounded-lg shadow-lg p-4",style:{display:"none"}},(0,e.createElement)("div",{id:"chatbot-options",class:"flex items-center justify-end"},(0,e.createElement)("a",{ref:b,onClick:()=>{p.current.classList.add("chat-fullscreen"),b.current.style.display="none",b.current.classList.remove("flex"),h.current.style.display="flex",h.current.classList.add("flex")},id:"chatbot-allow-fullscreen-button",class:"cursor-pointer items-center justify-center rounded-lg w-8 h-8 shadow-white",style:{display:"block"}},(0,e.createElement)("i",{class:"bi bi-arrows-fullscreen"})),(0,e.createElement)("a",{ref:h,onClick:()=>{p.current.classList.remove("chat-fullscreen"),b.current.style.display="flex",b.current.classList.add("flex"),h.current.style.display="none",h.current.classList.remove("flex")},id:"chatbot-minimize-button",class:"cursor-pointer items-center justify-center rounded-lg w-8 h-8 shadow-white",style:{display:"none"}},(0,e.createElement)("i",{class:"bi bi-fullscreen-exit"}))),(0,e.createElement)("div",{class:"chatbot-header p-4 rounded-lg mb-4 text-sm flex items-center gap-4 font-semibold"},(0,e.createElement)("span",{class:"chatbot-avatar flex items-center justify-center rounded-full py-2 px-3"},(0,e.createElement)("i",{class:"bi bi-robot text-2xl text-white"})),(0,a.__)("Hi, I'm Job, your job assistant, how can I help you?","nortic-plugin")),(0,e.createElement)("div",{ref:f,class:"chat-container flex flex-col gap-4 my-4 w-full h-64 p-8 overflow-scroll"},n.map((t=>(0,e.createElement)(e.Fragment,null,(0,e.createElement)("div",{key:t.message_date,"data-session":t.session,class:`chat-message flex flex-row items-start bg-white ${t.messageClasses} border border-gray-200 py-2 px-4 rounded-lg`},(0,e.createElement)("span",{class:"user-avatar rounded-full bg-gray-500 py-2 px-3 mr-4"},(0,e.createElement)("i",{class:`bi ${t.avatar}`})),(0,e.createElement)("div",{class:"user-message text-sm",style:{wordWrap:"break-word",width:"80%",display:"inline-block"}},t.text)),(0,e.createElement)("time",{class:"chat-message-time"},t.message_date),!u&&(0,e.createElement)(s.Spinner,null))))),(0,e.createElement)("div",{class:"relative w-full flex items-center mt-4"},(0,e.createElement)("textarea",{rows:2,onChange:e=>g(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),w(y),g(""),m(!1))},class:"w-full p-2.5 text-sm text-gray-900 bg-slate-50 rounded-lg border border-gray-300",value:y,onSubmit:w}))),(0,e.createElement)("div",{class:"relative w-full flex items-center justify-end mt-4"},(0,e.createElement)("a",{onClick:()=>{p.current.style.display=""==p.current.style.display||"none"==p.current.style.display?"block":"none"},id:"floating-chatbot-button",class:"floating-chatbot-button cursor-pointer flex items-center justify-center rounded-full w-14 h-14 shadow-white"},(0,e.createElement)("i",{class:"bi bi-chat-dots-fill text-4xl text-white"}))))}document.addEventListener("DOMContentLoaded",(()=>{const t=document.getElementById("chatbot");document.querySelector(".chatbot-container"),document.getElementById("chat-box"),document.getElementById("floating-chatbot-button"),(0,e.render)((0,e.createElement)(l,null),t)}))})();